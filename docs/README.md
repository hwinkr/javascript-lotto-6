# 도메인 로직

“소프트웨어가 해결하고자 하는 현실의 문제”를 소프트웨어 공학에서는 도메인이라고 표현하며 “도메인 로직”이란 그 현실의 문제를 해결해주는 코드를 의미합니다. 즉, 현실세계의 문제를 해결하기 위해서 직접적으로 관여를 하는 코드 덩어리라고 생각할 수 있습니다.

```
도메인 로직 == 현실 세계의 문제를 해결하기 위한 **의사결정을 하는 코드**
```

그렇다면, 도메인 로직을 통해 해결해야 하는 현실 문제인 “로또 게임”의 문제는 무엇일까에 대해서 생각해봤습니다. 한 문장으로 정리해보자면 **“과연, N개의 로또를 샀을 때 나의 당첨 내역과 수익률은 얼마인가?”라고 할 수 있습니다.** 이 문제를 해결하기 위한 목적을 가진 코드들을 묶어서 도메인 로직으로 표현하기로 했습니다.
그런데 “소프트웨어는 코드로 이루어져 있고, 그 코드들이 모여 현실 문제를 해결하니 소프트웨어의 모든 구성이 도메인 로직이 아닐까?” 라는 생각을 했습니다.

# 애플리케이션 서비스 로직

소프트웨어는 현실 세계의 문제를 직접적으로 해결하는 코드(도메인 로직) 이외에 다른 많은 코드들을 작성해야 합니다.

- 도메인 로직에 현실 문제를 전달(입력값 전달)
- 도메인 로직이 해결한 현실 문제를 출력

도메인 로직이 현실 문제를 해결하기 위해서는 도메인 로직에 문제를 전달해주는 로직도 필요합니다. 이 로직을 “애플리케이션 서비스 로직”이라고 합니다. 애플리케이션 서비스 로직은 **도메인 로직을 가능**하게 만듭니다. 예를 들어서, 데이터베이스를 통해서 현실 문제를 해결한다고 가정하면

- 데이터베이스에 로그인
- 백엔드 서버와 API를 통한 통신
- 사용자와의 인터렉션 처리

는 도메인 로직과 구분되는 애플리케이션 서비스 로직이라고 할 수 있습니다. 로또 게임에서 애플리케이션 서비스 로직이 될 수 있는 로직들에 대해서 생각해봤고,

1. 문제 해결을 위한 입력값 → 로또의 수익률을 판단하기 위해서 InputView를 통해서 로또 구매량, 로또 번호, 보너스 번호를 입력
2. 문제 해결 결과물을 해석하고 보여주고 전파 → 수익률을 판단하고 OutputView에 전파

로 정리할 수 있었습니다.

# 분리

## 도메인 로직

> 도메인 로직을 통해서 해결해야 하는 “로또 게임”의 문제는 “과연, N개의 로또를 샀을 때 나의 당첨 내역과 수익률은 얼마인가?” 입니다. 이 문제에 직접적으로 관여하는 도메인들은 어떤 것들이 있는가에 대해서 정리한 후 각 도메인을 표현하는 클래스를 구현하기로 했습니다

### Lotto

> 구매한 한장의 로또를 표현하는 클래스

- [ ] 필드(멤버 변수)를 구성한다.
- 로또 번호
- [ ] 로또 번호가 유효하지 않을 경우 예외처리한다.
- [ ] 유효성 검증
- `Number` 가 아닌 데이터 타입이 있는 경우
- 1 ~ 45 범위의 숫자가 아닌 숫자가 포함되어 있는 경우
- 6개의 숫자보다 적거나 많은 경우
- 중복된 숫자가 있는경우

### LottoWinningNumber

> 로또 당첨 번호를 표현하는 클래스

- [ ] 필드를 구성한다.
- 로또 당첨번호
- 보너스 번호
- [ ] LottoJudge 클래스에 당첨 번호, 보너스 번호를 전달한다.

### Bonus

> 로또 당첨 번호에서 보너스 번호를 표현하는 클래스

- [ ] 필드를 구성한다
- 보너스 번호
- [ ] 보너스 번호가 유효하지 않을 경우 예외처리한다.
- [ ] LottoWinningAnswer 클래스에 보너스 번호를 전달한다.

### LottoJudge

> 구입한 로또들의 당첨 내역 및 수익률을 판단하는 클래스

- [ ] 필드를 구성한다
- 로또 당첨 번호(LottoWinningAnswer)
- 각 등수에 해당하는 로또가 몇장인지를 표현하는 객체

```js
const lottoRank = {
  first: 0,
  second: 0,
  //...
};
```

- [ ] 로또 당첨을 판단하는 메서드를 구현한다
- [ ] 로또 수익률을 계산하는 메서드를 구현한다.

### LottoDomainManager

- [ ] 필드를 구성한다
- LottoWinningNumber
- LottoJudge
- lottoList(구매한 수량 만큼의 로또)

## 애플리케이션 서비스 로직

> 핵심 로직을 구현하는 코드와 UI를 담당하는 로직을 구분하기 → 비즈니스 로직, 화면 구분하기

### InputView

> 입력을 처리하는 메서드는 유효성 검증을 신경쓰지 않아야 한다. 유효성 검증은 클래스를 통해서 인스턴스를 생성할 때 하도록 한다. 콘솔 창을 통한 입력은 문자, 특수기호를 입력해도 알 수 없기 때문에 더 세밀한 유효성 검증이 필요할 것이다.

- [ ] 로또 구매 금액 입력받기
- [ ] 로또 당첨번호 입력받기
- [ ] 보너스 번호 입력받기

### OutputView

> 출력 과정에서 데이터를 조작하는 로직은 포함되지 않아야 합니다. View는 UI를 담당하는 로직이므로, 비즈니스 로직이 없어야 하기 때문입니다. 비즈니스 로직이 없어야 한다는 것은,
> 예를 들어 로또 번호를 오름차순해서 보여줄 때, 오름차순은 신경쓰지 않아야 합니다.

- [ ] 발행한 로또 수량 및 번호를 출력한다.
- [ ] 오름차순으로 정렬 된 로또 번호를 출력한다.
- [ ] 당첨 내역을 출력한다
- [ ] 소수점 둘 째 자리에서 반올림한 수익률을 출력한다

### ViewManager

- [ ] 필드를 구성한다
- inputView
- outputView

## 컨트롤러

> 어딘가에서 도메인이 “~~한 일을 해야 한다”고 알려줘야 합니다. 이를 책임지는 컨트롤러 클래스도 구현하기로 했습니다. 그리고, 컨트롤러에서 함수를 더 추상화해서 사용하기 위해서 도메인, 애플리케이션 서비스 로직을 한번 더 묶어서 관리하는 매니져 클래스도 구현하기로 했습니다.

- [ ] 필드를 구성한다
- LottoDomainManager
- ViewManager
- [ ] 로또 게임을 진행 시키는 메서드를 구현한다

## 기타

- [ ] 로또 게임과 관련된 메시지 상수 객체로 만들기
- [ ] 에러 메시지 상수 객체로 만들기
- [ ] 유효성 검증하는 함수 구현하기
